{"ast":null,"code":"/*\n    Copyright 2020 The caver-js Authors\n    This file is part of the caver-js library.\n\n    The caver-js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The caver-js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the caver-js. If not, see <http://www.gnu.org/licenses/>.\n*/\nconst BaseKIP7 = require('./kip7');\n\nconst BaseKIP17 = require('./kip17');\n\nconst core = require('../../caver-core');\n\nconst {\n  validateDeployParameterForKIP7,\n  validateDeployParameterForKIP17,\n  kip7ByteCode,\n  kip17ByteCode\n} = require('./kctHelper');\n\nclass KCT {\n  constructor(...args) {\n    const _this = this; // sets _requestmanager\n\n\n    core.packageInit(this, args); // overwrite package setRequestManager\n\n    const setRequestManager = this.setRequestManager;\n\n    this.setRequestManager = function (manager) {\n      setRequestManager(manager);\n      _this.kip7._requestManager = _this._requestManager;\n      _this.kip7.currentProvider = _this._provider;\n      _this.kip17._requestManager = _this._requestManager;\n      _this.kip17.currentProvider = _this._provider;\n      return true;\n    }; // overwrite setProvider\n\n\n    const setProvider = this.setProvider;\n\n    this.setProvider = function () {\n      setProvider.apply(_this, arguments);\n\n      _this.setRequestManager(_this._requestManager);\n    }; // Define KIP7 class for caver-kct\n    // In this class, keyrings will be used instead of accounts\n\n\n    class KIP7 extends BaseKIP7 {\n      static deploy(tokenInfo, deployer) {\n        validateDeployParameterForKIP7(tokenInfo);\n        const {\n          name,\n          symbol,\n          decimals,\n          initialSupply\n        } = tokenInfo;\n        const kip7 = new KIP7();\n        return kip7.deploy({\n          data: kip7ByteCode,\n          arguments: [name, symbol, decimals, initialSupply]\n        }).send({\n          from: deployer,\n          gas: 4000000,\n          value: 0\n        });\n      }\n\n      constructor(tokenAddress, abi) {\n        super(tokenAddress, abi);\n        const self = this; // eslint-disable-line no-shadow\n\n        const setRequestManager = _this.setRequestManager; // eslint-disable-line no-shadow\n\n        _this.setRequestManager = function () {\n          setRequestManager.apply(_this, arguments);\n          core.packageInit(self, [_this]);\n        };\n\n        this.setKeyrings(args[0].wallet);\n      }\n\n    }\n\n    this.kip7 = KIP7; // Define KIP7 class for caver-kct\n    // In this class, keyrings will be used instead of accounts\n\n    class KIP17 extends BaseKIP17 {\n      static deploy(tokenInfo, deployer) {\n        validateDeployParameterForKIP17(tokenInfo);\n        const {\n          name,\n          symbol\n        } = tokenInfo;\n        const kip17 = new KIP17();\n        return kip17.deploy({\n          data: kip17ByteCode,\n          arguments: [name, symbol]\n        }).send({\n          from: deployer,\n          gas: 6600000,\n          value: 0\n        });\n      }\n\n      constructor(tokenAddress, abi) {\n        super(tokenAddress, abi);\n        const self = this; // eslint-disable-line no-shadow\n\n        const setRequestManager = _this.setRequestManager; // eslint-disable-line no-shadow\n\n        _this.setRequestManager = function () {\n          setRequestManager.apply(_this, arguments);\n          core.packageInit(self, [_this]);\n        };\n\n        this.setKeyrings(args[0].wallet);\n      }\n\n    }\n\n    this.kip17 = KIP17;\n  }\n\n}\n\nmodule.exports = KCT;","map":null,"metadata":{},"sourceType":"script"}