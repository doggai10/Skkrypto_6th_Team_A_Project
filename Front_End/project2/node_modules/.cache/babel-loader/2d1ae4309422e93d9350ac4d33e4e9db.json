{"ast":null,"code":"var _jsxFileName = \"/Users/heeje/Desktop/Projcet_A/Front_End/project2/src/Routes/FundingApply/ApplyContainer.js\";\nimport React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport ApplyPresenter from \"./ApplyrPresenter\";\nimport Http from \"Api/api\";\nimport { useHistory } from \"react-router-dom\";\nimport { cav } from \"Caver/caver\";\nimport Contract from \"Contracts/contract\";\nimport \"antd/dist/antd.css\";\nimport { Spin } from \"antd\";\nconst Container = styled.div`\n    overflow: auto;\n`;\n\nfunction getToday() {\n  const date = new Date();\n  const year = date.getFullYear();\n  const month = (\"0\" + (1 + date.getMonth())).slice(-2);\n  const day = (\"0\" + date.getDate()).slice(-2);\n  const hours = date.getHours();\n  return year + month + day + hours;\n}\n\nconst Loader = styled(Spin)`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n`;\n\nconst ApplyContainer = () => {\n  const [wallet, setWallet] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [sale, setSale] = useState(\"\");\n  const [startDate, setStartDate] = useState(new Date());\n  const [money, setMoney] = useState(null);\n  const [quantity, setQuantity] = useState(null);\n  const [loading, setLoading] = useState(false);\n  console.log(loading);\n  const history = useHistory();\n\n  const handleWallet = e => {\n    setWallet(e.target.value);\n  };\n\n  const handleName = e => {\n    setName(e.target.value);\n  };\n\n  const handleContent = e => {\n    setContent(e.target.value);\n  };\n\n  const handleSale = e => {\n    setSale(e.target.value);\n  };\n\n  const handleMoney = e => {\n    setMoney(e.target.value);\n  };\n\n  const handleQuantity = e => {\n    setQuantity(e.target.value);\n  }; //신청서 제출.\n\n\n  const handleForm = async e => {\n    e.preventDefault();\n    setLoading(true);\n    const date = getToday(startDate);\n    const info = {\n      wallet,\n      name,\n      content,\n      sale,\n      date,\n      money,\n      quantity\n    };\n    const contractInstance = new cav.contract(Contract.abi, Contract.address);\n    console.log(contractInstance);\n\n    try {\n      const deployer = cav.wallet.keyring.createFromPrivateKey(wallet);\n      cav.wallet.add(deployer);\n      const respose = await Http.post(\"/apply\", info);\n      const funding = await contractInstance.methods.createFunding(deployer.address, sale, Date.now(), quantity, money).call();\n      const klay = cav.utils.convertToPeb(money, \"Ston\");\n      const find = await contractInstance.methods.findTarget(deployer.address, sale, klay).send({\n        from: deployer.address,\n        gas: \"250000\"\n      });\n      console.log(respose);\n      console.log(funding, find);\n      alert(\"저장 성공!\");\n      alert(\"관리자 검토 후 등록 완료됩니다.\");\n    } catch (e) {\n      console.log(e);\n    }\n\n    setLoading(false);\n    history.push(\"/\");\n  };\n\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  }, loading ? /*#__PURE__*/React.createElement(Loader, {\n    tip: \"Loading...\",\n    size: \"large\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 24\n    }\n  }) : null, /*#__PURE__*/React.createElement(ApplyPresenter, {\n    wallet: wallet,\n    name: name,\n    content: content,\n    sale: sale,\n    startDate: startDate,\n    money: money,\n    quantity: quantity,\n    handleWallet: handleWallet,\n    handleName: handleName,\n    handleContent: handleContent,\n    handleSale: handleSale,\n    handleForm: handleForm,\n    setStartDate: setStartDate,\n    handleMoney: handleMoney,\n    handleQuantity: handleQuantity,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }));\n};\n\nexport default ApplyContainer;","map":{"version":3,"sources":["/Users/heeje/Desktop/Projcet_A/Front_End/project2/src/Routes/FundingApply/ApplyContainer.js"],"names":["React","useState","styled","ApplyPresenter","Http","useHistory","cav","Contract","Spin","Container","div","getToday","date","Date","year","getFullYear","month","getMonth","slice","day","getDate","hours","getHours","Loader","ApplyContainer","wallet","setWallet","name","setName","content","setContent","sale","setSale","startDate","setStartDate","money","setMoney","quantity","setQuantity","loading","setLoading","console","log","history","handleWallet","e","target","value","handleName","handleContent","handleSale","handleMoney","handleQuantity","handleForm","preventDefault","info","contractInstance","contract","abi","address","deployer","keyring","createFromPrivateKey","add","respose","post","funding","methods","createFunding","now","call","klay","utils","convertToPeb","find","findTarget","send","from","gas","alert","push"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport ApplyPresenter from \"./ApplyrPresenter\";\nimport Http from \"Api/api\";\nimport { useHistory } from \"react-router-dom\";\nimport { cav } from \"Caver/caver\";\nimport Contract from \"Contracts/contract\";\nimport \"antd/dist/antd.css\";\nimport { Spin } from \"antd\";\n\nconst Container = styled.div`\n    overflow: auto;\n`;\n\nfunction getToday() {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = (\"0\" + (1 + date.getMonth())).slice(-2);\n    const day = (\"0\" + date.getDate()).slice(-2);\n    const hours = date.getHours();\n    return year + month + day + hours;\n}\n\nconst Loader = styled(Spin)`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n`;\n\nconst ApplyContainer = () => {\n    const [wallet, setWallet] = useState(\"\");\n    const [name, setName] = useState(\"\");\n    const [content, setContent] = useState(\"\");\n    const [sale, setSale] = useState(\"\");\n    const [startDate, setStartDate] = useState(new Date());\n    const [money, setMoney] = useState(null);\n    const [quantity, setQuantity] = useState(null);\n    const [loading, setLoading] = useState(false);\n    console.log(loading);\n    const history = useHistory();\n\n    const handleWallet = (e) => {\n        setWallet(e.target.value);\n    };\n\n    const handleName = (e) => {\n        setName(e.target.value);\n    };\n\n    const handleContent = (e) => {\n        setContent(e.target.value);\n    };\n\n    const handleSale = (e) => {\n        setSale(e.target.value);\n    };\n\n    const handleMoney = (e) => {\n        setMoney(e.target.value);\n    };\n\n    const handleQuantity = (e) => {\n        setQuantity(e.target.value);\n    };\n\n    //신청서 제출.\n    const handleForm = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n        const date = getToday(startDate);\n        const info = {\n            wallet,\n            name,\n            content,\n            sale,\n            date,\n            money,\n            quantity,\n        };\n        const contractInstance = new cav.contract(\n            Contract.abi,\n            Contract.address\n        );\n        console.log(contractInstance);\n\n        try {\n            const deployer = cav.wallet.keyring.createFromPrivateKey(wallet);\n            cav.wallet.add(deployer);\n            const respose = await Http.post(\"/apply\", info);\n            const funding = await contractInstance.methods\n                .createFunding(\n                    deployer.address,\n                    sale,\n                    Date.now(),\n                    quantity,\n                    money\n                )\n                .call();\n            const klay = cav.utils.convertToPeb(money, \"Ston\");\n            const find = await contractInstance.methods\n                .findTarget(deployer.address, sale, klay)\n                .send({\n                    from: deployer.address,\n                    gas: \"250000\",\n                });\n            console.log(respose);\n            console.log(funding, find);\n            alert(\"저장 성공!\");\n            alert(\"관리자 검토 후 등록 완료됩니다.\");\n        } catch (e) {\n            console.log(e);\n        }\n        setLoading(false);\n        history.push(\"/\");\n    };\n\n    return (\n        <Container>\n            {loading ? <Loader tip=\"Loading...\" size=\"large\"></Loader> : null}\n            <ApplyPresenter\n                wallet={wallet}\n                name={name}\n                content={content}\n                sale={sale}\n                startDate={startDate}\n                money={money}\n                quantity={quantity}\n                handleWallet={handleWallet}\n                handleName={handleName}\n                handleContent={handleContent}\n                handleSale={handleSale}\n                handleForm={handleForm}\n                setStartDate={setStartDate}\n                handleMoney={handleMoney}\n                handleQuantity={handleQuantity}\n            ></ApplyPresenter>\n        </Container>\n    );\n};\n\nexport default ApplyContainer;\n"]},"metadata":{},"sourceType":"module"}