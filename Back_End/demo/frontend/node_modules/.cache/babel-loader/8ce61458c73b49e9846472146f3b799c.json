{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n    position: absolute;\\n    top: 50%;\\n    left: 50%;\\n    transform: translate(-50%, -50%);\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect,useCallback}from\"react\";import styled from\"styled-components\";import FundingDetailPresenter from\"./FundingDetailPresenter\";import{cav}from\"Caver/caver\";import Contract from\"Contracts/contract\";import axios from\"axios\";import\"antd/dist/antd.css\";import{Spin}from\"antd\";var Container=styled.div(_templateObject());var Loader=styled(Spin)(_templateObject2());var FundingDetailContainer=function FundingDetailContainer(_ref){var match=_ref.match,location=_ref.location;//컨트랙트 인스턴스 생성\nvar contractInstance=new cav.contract(Contract.abi,Contract.address);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),fundingvisible=_useState2[0],setVisible=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),cancelVisible=_useState4[0],setCancel=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),privkey=_useState6[0],setPrivkey=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),fundingAmount=_useState8[0],setFundingAmount=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loading=_useState10[0],setLoading=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),totalLoading=_useState12[0],setTotalLoading=_useState12[1];// 개인키 상태 계속 업데이트\nvar handleKey=function handleKey(e){setPrivkey(e.target.value);};// 모달 창에서 취소버튼 눌렀을때\nvar Cancel=function Cancel(e){e.preventDefault();setVisible(false);};var amount=0.1;// 펀딩하기 버튼에서 확인 버튼 눌렀을 때\nvar handleOk=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var deployer,value;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(privkey===\"\")){_context.next=4;break;}alert(\"키를 입력해주세요!\");return _context.abrupt(\"return\");case 4:setVisible(false);setLoading(true);console.log(contractInstance);deployer=cav.wallet.keyring.createFromPrivateKey(privkey);cav.wallet.add(deployer);_context.prev=9;_context.next=12;return contractInstance.methods.deposit().send({from:deployer.address,gas:\"250000\",value:cav.utils.convertToPeb(String(amount),\"KLAY\")});case 12:value=_context.sent;alert(\"펀딩 성공!\");cav.wallet.remove(deployer.address);console.log(value);_context.next=22;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](9);alert(\"펀딩 실패ㅜㅜ\");console.log(_context.t0);case 22:setLoading(false);setPrivkey(\"\");// 펀딩 완료시.\ncase 24:case\"end\":return _context.stop();}}},_callee,null,[[9,18]]);}));return function handleOk(_x){return _ref2.apply(this,arguments);};}();// 펀딩하기 버튼 눌렀을때.\nvar handleFunding=function handleFunding(e){setVisible(true);};// 펀딩 취소하기 눌렀을 때.\nvar handleCancel=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setCancel(true);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function handleCancel(_x2){return _ref3.apply(this,arguments);};}();var handleCancelInsideCancel=function handleCancelInsideCancel(){setCancel(false);};// 환불 받기 버튼 속 확인 버튼 누를 때\nvar fundingCancelOk=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var v,deployer,reci;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();setCancel(false);setLoading(true);if(!(privkey===\"\")){_context3.next=6;break;}alert(\"키를 입력해주세요!\");return _context3.abrupt(\"return\");case 6:v=cav.utils.convertToPeb(\"0.1\",\"KLAY\");_context3.prev=7;deployer=cav.wallet.keyring.createFromPrivateKey(privkey);cav.wallet.add(deployer);_context3.next=12;return contractInstance.methods.transfer(v).send({from:deployer.address,gas:\"250000\"});case 12:reci=_context3.sent;console.log(reci);cav.wallet.remove(deployer.address);alert(\"취소 완료!\");_context3.next=21;break;case 18:_context3.prev=18;_context3.t0=_context3[\"catch\"](7);console.log(_context3.t0);case 21:setLoading(false);case 22:case\"end\":return _context3.stop();}}},_callee3,null,[[7,18]]);}));return function fundingCancelOk(_x3){return _ref4.apply(this,arguments);};}();var getMarketData=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var url;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:url=location.pathname;try{// const MarketData = await axios.get(`${url}`);\n// console.log(MarketData.data.getMoney);\n}catch(e){console.log(e);alert(\"정보 불러오기 실패\");}case 2:case\"end\":return _context4.stop();}}},_callee4);})),[location.pathname]);useEffect(function(){setTotalLoading(true);getMarketData();setTotalLoading(false);},[getMarketData]);if(totalLoading){return React.createElement(Loader,{tip:\"Loading...\",size:\"large\"});}return React.createElement(Container,null,loading?React.createElement(Loader,{tip:\"Loading...\",size:\"large\"}):null,React.createElement(FundingDetailPresenter,{fundingvisible:fundingvisible,privkey:privkey,handleFunding:handleFunding,handleCancel:handleCancel,handleOk:handleOk,handleKey:handleKey,Cancel:Cancel,cancelVisible:cancelVisible,handleCancelInsideCancel:handleCancelInsideCancel,fundingCancelOk:fundingCancelOk}));};export default FundingDetailContainer;","map":{"version":3,"sources":["/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/src/Routes/FundingDetail/FundingDetailContainer.js"],"names":["React","useState","useEffect","useCallback","styled","FundingDetailPresenter","cav","Contract","axios","Spin","Container","div","Loader","FundingDetailContainer","match","location","contractInstance","contract","abi","address","fundingvisible","setVisible","cancelVisible","setCancel","privkey","setPrivkey","fundingAmount","setFundingAmount","loading","setLoading","totalLoading","setTotalLoading","handleKey","e","target","value","Cancel","preventDefault","amount","handleOk","alert","console","log","deployer","wallet","keyring","createFromPrivateKey","add","methods","deposit","send","from","gas","utils","convertToPeb","String","remove","handleFunding","handleCancel","handleCancelInsideCancel","fundingCancelOk","v","transfer","reci","getMarketData","url","pathname"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport styled from \"styled-components\";\nimport FundingDetailPresenter from \"./FundingDetailPresenter\";\nimport { cav } from \"Caver/caver\";\nimport Contract from \"Contracts/contract\";\nimport axios from \"axios\";\nimport \"antd/dist/antd.css\";\nimport { Spin } from \"antd\";\n\nconst Container = styled.div``;\n\nconst Loader = styled(Spin)`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n`;\nconst FundingDetailContainer = ({ match, location }) => {\n    //컨트랙트 인스턴스 생성\n    const contractInstance = new cav.contract(Contract.abi, Contract.address);\n    const [fundingvisible, setVisible] = useState(false);\n    const [cancelVisible, setCancel] = useState(false);\n    const [privkey, setPrivkey] = useState(\"\");\n\n    const [fundingAmount, setFundingAmount] = useState(0);\n\n    const [loading, setLoading] = useState(false);\n    const [totalLoading, setTotalLoading] = useState(false);\n\n    // 개인키 상태 계속 업데이트\n    const handleKey = (e) => {\n        setPrivkey(e.target.value);\n    };\n\n    // 모달 창에서 취소버튼 눌렀을때\n\n    const Cancel = (e) => {\n        e.preventDefault();\n        setVisible(false);\n    };\n\n    const amount = 0.1;\n\n    // 펀딩하기 버튼에서 확인 버튼 눌렀을 때\n    const handleOk = async (e) => {\n        e.preventDefault();\n\n        if (privkey === \"\") {\n            alert(\"키를 입력해주세요!\");\n            return;\n        }\n\n        setVisible(false);\n        setLoading(true);\n\n        console.log(contractInstance);\n\n        const deployer = cav.wallet.keyring.createFromPrivateKey(privkey);\n        cav.wallet.add(deployer);\n        try {\n            const value = await contractInstance.methods.deposit().send({\n                from: deployer.address,\n                gas: \"250000\",\n                value: cav.utils.convertToPeb(String(amount), \"KLAY\"),\n            });\n            alert(\"펀딩 성공!\");\n            cav.wallet.remove(deployer.address);\n            console.log(value);\n        } catch (e) {\n            alert(\"펀딩 실패ㅜㅜ\");\n            console.log(e);\n        }\n        setLoading(false);\n        setPrivkey(\"\");\n\n        // 펀딩 완료시.\n    };\n\n    // 펀딩하기 버튼 눌렀을때.\n    const handleFunding = (e) => {\n        setVisible(true);\n    };\n\n    // 펀딩 취소하기 눌렀을 때.\n    const handleCancel = async (e) => {\n        setCancel(true);\n    };\n\n    const handleCancelInsideCancel = () => {\n        setCancel(false);\n    };\n\n    // 환불 받기 버튼 속 확인 버튼 누를 때\n    const fundingCancelOk = async (e) => {\n        e.preventDefault();\n        setCancel(false);\n        setLoading(true);\n        if (privkey === \"\") {\n            alert(\"키를 입력해주세요!\");\n            return;\n        }\n\n        const v = cav.utils.convertToPeb(\"0.1\", \"KLAY\");\n        try {\n            const deployer = cav.wallet.keyring.createFromPrivateKey(privkey);\n            cav.wallet.add(deployer);\n\n            const reci = await contractInstance.methods.transfer(v).send({\n                from: deployer.address,\n                gas: \"250000\",\n            });\n            console.log(reci);\n            cav.wallet.remove(deployer.address);\n            alert(\"취소 완료!\");\n        } catch (e) {\n            console.log(e);\n        }\n        setLoading(false);\n    };\n\n    const getMarketData = useCallback(async () => {\n        const url = location.pathname;\n\n        try {\n            // const MarketData = await axios.get(`${url}`);\n            // console.log(MarketData.data.getMoney);\n        } catch (e) {\n            console.log(e);\n            alert(\"정보 불러오기 실패\");\n        }\n    }, [location.pathname]);\n\n    useEffect(() => {\n        setTotalLoading(true);\n        getMarketData();\n        setTotalLoading(false);\n    }, [getMarketData]);\n\n    if (totalLoading) {\n        return <Loader tip=\"Loading...\" size=\"large\"></Loader>;\n    }\n\n    return (\n        <Container>\n            {loading ? <Loader tip=\"Loading...\" size=\"large\"></Loader> : null}\n            <FundingDetailPresenter\n                fundingvisible={fundingvisible}\n                privkey={privkey}\n                handleFunding={handleFunding}\n                handleCancel={handleCancel}\n                handleOk={handleOk}\n                handleKey={handleKey}\n                Cancel={Cancel}\n                cancelVisible={cancelVisible}\n                handleCancelInsideCancel={handleCancelInsideCancel}\n                fundingCancelOk={fundingCancelOk}\n            ></FundingDetailPresenter>\n        </Container>\n    );\n};\n\nexport default FundingDetailContainer;\n"]},"metadata":{},"sourceType":"module"}