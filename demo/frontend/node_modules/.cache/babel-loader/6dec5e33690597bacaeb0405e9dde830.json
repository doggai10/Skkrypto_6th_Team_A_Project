{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n    position: absolute;\\n    top: 50%;\\n    left: 50%;\\n    transform: translate(-50%, -50%);\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n    overflow: auto;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState}from\"react\";import styled from\"styled-components\";import ApplyPresenter from\"./ApplyrPresenter\";import Http from\"Api/api\";import{useHistory}from\"react-router-dom\";import{cav}from\"Caver/caver\";import Contract from\"Contracts/contract\";import\"antd/dist/antd.css\";import{Spin}from\"antd\";var Container=styled.div(_templateObject());function getToday(){var date=new Date();var year=date.getFullYear();var month=(\"0\"+(1+date.getMonth())).slice(-2);var day=(\"0\"+date.getDate()).slice(-2);var hours=date.getHours();return year+month+day+hours;}var Loader=styled(Spin)(_templateObject2());var ApplyContainer=function ApplyContainer(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),wallet=_useState2[0],setWallet=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),content=_useState6[0],setContent=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),sale=_useState8[0],setSale=_useState8[1];var _useState9=useState(new Date()),_useState10=_slicedToArray(_useState9,2),startDate=_useState10[0],setStartDate=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),money=_useState12[0],setMoney=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),quantity=_useState14[0],setQuantity=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),loading=_useState16[0],setLoading=_useState16[1];console.log(loading);var history=useHistory();var handleWallet=function handleWallet(e){setWallet(e.target.value);};var handleName=function handleName(e){setName(e.target.value);};var handleContent=function handleContent(e){setContent(e.target.value);};var handleSale=function handleSale(e){setSale(e.target.value);};var handleMoney=function handleMoney(e){setMoney(e.target.value);};var handleQuantity=function handleQuantity(e){setQuantity(e.target.value);};//신청서 제출.\nvar handleForm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var date,info,contractInstance,deployer,respose,funding,klay,find;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setLoading(true);date=getToday(startDate);info={wallet:wallet,name:name,content:content,sale:sale,date:date,money:money,quantity:quantity};contractInstance=new cav.contract(Contract.abi,Contract.address);console.log(contractInstance);_context.prev=6;deployer=cav.wallet.keyring.createFromPrivateKey(wallet);cav.wallet.add(deployer);_context.next=11;return Http.post(\"/apply\",info);case 11:respose=_context.sent;_context.next=14;return contractInstance.methods.createFunding(deployer.address,sale,Date.now(),quantity,money).call();case 14:funding=_context.sent;klay=cav.utils.convertToPeb(money,\"Ston\");_context.next=18;return contractInstance.methods.findTarget(deployer.address,sale,klay).send({from:deployer.address,gas:\"250000\"});case 18:find=_context.sent;console.log(respose);console.log(funding,find);alert(\"저장 성공!\");alert(\"관리자 검토 후 등록 완료됩니다.\");_context.next=29;break;case 25:_context.prev=25;_context.t0=_context[\"catch\"](6);alert(\"저장 실패\");console.log(_context.t0);case 29:setLoading(false);history.push(\"/\");case 31:case\"end\":return _context.stop();}}},_callee,null,[[6,25]]);}));return function handleForm(_x){return _ref.apply(this,arguments);};}();return React.createElement(Container,null,loading?React.createElement(Loader,{tip:\"Loading...\",size:\"large\"}):null,React.createElement(ApplyPresenter,{wallet:wallet,name:name,content:content,sale:sale,startDate:startDate,money:money,quantity:quantity,handleWallet:handleWallet,handleName:handleName,handleContent:handleContent,handleSale:handleSale,handleForm:handleForm,setStartDate:setStartDate,handleMoney:handleMoney,handleQuantity:handleQuantity}));};export default ApplyContainer;","map":{"version":3,"sources":["/Users/kimdoheon/IdeaProjects/skkrypto/Back_End/demo/frontend/src/Routes/FundingApply/ApplyContainer.js"],"names":["React","useState","styled","ApplyPresenter","Http","useHistory","cav","Contract","Spin","Container","div","getToday","date","Date","year","getFullYear","month","getMonth","slice","day","getDate","hours","getHours","Loader","ApplyContainer","wallet","setWallet","name","setName","content","setContent","sale","setSale","startDate","setStartDate","money","setMoney","quantity","setQuantity","loading","setLoading","console","log","history","handleWallet","e","target","value","handleName","handleContent","handleSale","handleMoney","handleQuantity","handleForm","preventDefault","info","contractInstance","contract","abi","address","deployer","keyring","createFromPrivateKey","add","post","respose","methods","createFunding","now","call","funding","klay","utils","convertToPeb","findTarget","send","from","gas","find","alert","push"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport ApplyPresenter from \"./ApplyrPresenter\";\nimport Http from \"Api/api\";\nimport { useHistory } from \"react-router-dom\";\nimport { cav } from \"Caver/caver\";\nimport Contract from \"Contracts/contract\";\nimport \"antd/dist/antd.css\";\nimport { Spin } from \"antd\";\n\nconst Container = styled.div`\n    overflow: auto;\n`;\n\nfunction getToday() {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = (\"0\" + (1 + date.getMonth())).slice(-2);\n    const day = (\"0\" + date.getDate()).slice(-2);\n    const hours = date.getHours();\n    return year + month + day + hours;\n}\n\nconst Loader = styled(Spin)`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n`;\n\nconst ApplyContainer = () => {\n    const [wallet, setWallet] = useState(\"\");\n    const [name, setName] = useState(\"\");\n    const [content, setContent] = useState(\"\");\n    const [sale, setSale] = useState(\"\");\n    const [startDate, setStartDate] = useState(new Date());\n    const [money, setMoney] = useState(null);\n    const [quantity, setQuantity] = useState(null);\n    const [loading, setLoading] = useState(false);\n    console.log(loading);\n    const history = useHistory();\n\n    const handleWallet = (e) => {\n        setWallet(e.target.value);\n    };\n\n    const handleName = (e) => {\n        setName(e.target.value);\n    };\n\n    const handleContent = (e) => {\n        setContent(e.target.value);\n    };\n\n    const handleSale = (e) => {\n        setSale(e.target.value);\n    };\n\n    const handleMoney = (e) => {\n        setMoney(e.target.value);\n    };\n\n    const handleQuantity = (e) => {\n        setQuantity(e.target.value);\n    };\n\n    //신청서 제출.\n    const handleForm = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n        const date = getToday(startDate);\n        const info = {\n            wallet,\n            name,\n            content,\n            sale,\n            date,\n            money,\n            quantity,\n        };\n        const contractInstance = new cav.contract(\n            Contract.abi,\n            Contract.address\n        );\n        console.log(contractInstance);\n\n        try {\n            const deployer = cav.wallet.keyring.createFromPrivateKey(wallet);\n            cav.wallet.add(deployer);\n            const respose = await Http.post(\"/apply\", info);\n            const funding = await contractInstance.methods\n                .createFunding(\n                    deployer.address,\n                    sale,\n                    Date.now(),\n                    quantity,\n                    money\n                )\n                .call();\n            const klay = cav.utils.convertToPeb(money, \"Ston\");\n            const find = await contractInstance.methods\n                .findTarget(deployer.address, sale, klay)\n                .send({\n                    from: deployer.address,\n                    gas: \"250000\",\n                });\n            console.log(respose);\n            console.log(funding, find);\n            alert(\"저장 성공!\");\n            alert(\"관리자 검토 후 등록 완료됩니다.\");\n        } catch (e) {\n            alert(\"저장 실패\");\n            console.log(e);\n        }\n        setLoading(false);\n        history.push(\"/\");\n    };\n\n    return (\n        <Container>\n            {loading ? <Loader tip=\"Loading...\" size=\"large\"></Loader> : null}\n            <ApplyPresenter\n                wallet={wallet}\n                name={name}\n                content={content}\n                sale={sale}\n                startDate={startDate}\n                money={money}\n                quantity={quantity}\n                handleWallet={handleWallet}\n                handleName={handleName}\n                handleContent={handleContent}\n                handleSale={handleSale}\n                handleForm={handleForm}\n                setStartDate={setStartDate}\n                handleMoney={handleMoney}\n                handleQuantity={handleQuantity}\n            ></ApplyPresenter>\n        </Container>\n    );\n};\n\nexport default ApplyContainer;\n"]},"metadata":{},"sourceType":"module"}